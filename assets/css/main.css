/* =============================================
   MOBILE NAV FIX PACK — K‑MediSpring (2025-11-04)
   by Roni — paste this AT THE VERY BOTTOM of /assets/css/main.css
   Purpose: unify the mobile menu behavior and remove conflicts.
   ============================================= */

/* --- 0) Reset conflicting #menu styles set earlier --- */
@media (max-width: 980px){
  /* Some rules above set #menu to right: -320px; others to left: -100%;
     We HARD-RESET key properties here to a single left-slide pattern. */
  #menu{
    position: fixed !important;
    top: 0 !important;
    left: 0 !important;
    right: auto !important;
    width: 320px !important;
    max-width: 86vw !important;
    height: 100vh !important;
    background: #fff !important;
    box-shadow: 2px 0 12px rgba(0,0,0,.12) !important;
    transform: translateX(-100%) !important;
    transition: transform .28s ease !important;
    z-index: 10001 !important;
    overflow-y: auto !important;
    -webkit-overflow-scrolling: touch !important;
    padding: 1.25rem 1rem !important;
  }
  /* open state (toggled by body.is-menu-visible) */
  body.is-menu-visible #menu{ transform: translateX(0) !important; }

  /* link touch-targets */
  #menu a{ display:block; padding:.9rem .6rem; color:#111 !important; text-decoration:none; }
  #menu a:hover{ color:#0b66c3 !important; background: none !important; }

  /* overlay for outside-click to close (uses body::before layer) */
  body::before{
    content:""; position: fixed; inset: 0; background: rgba(0,0,0,.28);
    opacity: 0; pointer-events: none; transition: opacity .2s ease; z-index: 10000;
  }
  body.is-menu-visible::before{ opacity: 1; pointer-events: auto; }
}

/* --- 1) Single, consistent toggle button (.menuToggle) --- */
/* Keep ONE class across HTML & JS: .menuToggle
   If #header .toggle or #sidebar .toggle existed, they can stay hidden on mobile. */
@media (max-width: 980px){
  .menuToggle{
    display:inline-flex !important; align-items:center; gap:.4rem;
    position:absolute; top: 14px; right: 16px; z-index: 20000;
    padding: .5rem .65rem; background:#fff; border:1px solid rgba(0,0,0,.15);
    border-radius: 8px; text-decoration:none; font-size:.95rem; line-height:1;
  }
  .menuToggle .bars{ display:inline-block; width:18px; height:2px; background:#111; box-shadow: 0 6px 0 #111, 0 -6px 0 #111; border-radius:2px; }
  /* If the template had #header .toggle, hide it to avoid duplicates */
  #header .toggle{ display:none !important; }
}
@media (min-width: 981px){ .menuToggle{ display:none !important; } }

/* --- 2) Prevent other #menu variants from re-appearing on desktop --- */
@media (min-width: 981px){
  /* Desktop keeps original sidebar/menu inline; ensure no offcanvas leftovers */
  #menu{
    position: static !important; left:auto !important; right:auto !important;
    height: auto !important; width: auto !important; transform:none !important;
    box-shadow: none !important; padding: 0 !important; background: transparent !important;
  }
}

/* --- 3) Z-index order: modal > menu > header --- */
#wechatModal{ z-index: 11000 !important; }
@media (max-width: 980px){ #menu{ z-index: 10001 !important; } #header{ z-index: 10002; position:relative; } }

/* --- 4) Accessibility hints --- */
#menu[aria-hidden="true"]{ visibility: hidden; }
body.is-menu-visible #menu[aria-hidden="true"]{ visibility: visible; }

/* --- 5) Optional: animated focus ring for links in menu --- */
#menu a:focus{ outline: none; box-shadow: 0 0 0 3px rgba(0,102,204,.2); border-radius: 8px; }

/* --- 6) Kill duplicated/legacy rules that force right-side panel --- */
/* NOTE: If there are previous blocks like `#menu { right:-320px }` or
   `body.is-menu-visible #menu { right:0 }`, they’re harmless now due to our
   explicit left/transform + !important overrides above. No need to chase them. */

/* =============================================
   END of Fix Pack
   ============================================= */

/* (Bonus) If your JS doesn’t currently toggle body.is-menu-visible, use this:
<script>
  document.addEventListener('click', function(e){
    const t = e.target.closest('.menuToggle');
    if(!t) return;
    e.preventDefault();
    document.body.classList.toggle('is-menu-visible');
  });
  // Close on ESC
  document.addEventListener('keydown', function(e){
    if(e.key === 'Escape') document.body.classList.remove('is-menu-visible');
  });
  // Close when clicking overlay
  document.addEventListener('click', function(e){
    if(document.body.classList.contains('is-menu-visible') && e.target === document.body){
      document.body.classList.remove('is-menu-visible');
    }
  });
</script>
*/
